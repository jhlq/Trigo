<!DOCTYPE html>
<html>
	<head>
    <title>Trigo</title>
	<meta charset="utf-8"/>
	</head>
  <body>
	  <h1>Trigo!</h1>
	  
  	<input type="number" id="x" onchange="crosshair()" value=1>
	<input type="number" id="y" onchange="crosshair()" value=1>
	<br>
	<button onclick="board.letAIplay()">Let AI play!</button>
	<button onclick="sb.board.pass();sb.placeMoves()">Pass.</button>
	<button onclick="sb.board.undo();sb.placeMoves()">Undo.</button>
	<button onclick="sb.updatescore()">Score.</button>
	<br>
	<button onclick="sb.plotinfluence()">Plot influence.</button>
	<button onclick="sb.board.autoMarkDeadStones();sb.placeMoves()">Mark dead stones.</button>
	<br>
	<canvas id="TriCanvas" width=600 height="540"></canvas>
	<p id="scores"></p>
	<label for="shortcuts">Enable keyboard shortcuts (w a s d and e to enter): </label>
	<input type="checkbox" id="shortcuts" checked="true">
	<br>
	
	<p>Canvas size: 
	<input type="number" id="canvassize" step="100" value=600>
	Unit size: 
	<input type="number" id="unitsize" step="5" value=25>
	Side length (y rows): 
	<input type="number" id="sidelength" step="1" value=13>
	<button onclick="changesize()">Change.</button>
	</p>
	
    Game record: <input type="text" id="board_moves" value=''>
  <button class="btn btn-primary" onclick="sb.loadGame()">Load game record (paste first).</button>
  
  <script type="text/javascript" src="trigolib.js"></script>
<script type="text/javascript" src="screenboard.js"></script>

<script>
/*var t=new Trigo.Triangle(0,0);
var tg=new Trigo.TriangleGrid(3);
var b=new Trigo.Board(3);*/
var sb=new Trigo.ScreenBoard("TriCanvas",9,30,50,50);
sb.drawGrid();


document.body.addEventListener("keydown", keyDown, false);
function keyDown(e) {
	if (document.getElementById("shortcuts")==null || typeof(document.getElementById("shortcuts"))=="undefined"){
		document.removeEventListener("keydown", keyDown);
	} else if (document.getElementById("shortcuts").checked){
		
		var k = e.keyCode; //enter is 13
		//alert(k)
		if(k==83) { //s
			//submit();
			document.getElementById("y").value=parseInt(document.getElementById("y").value)+1;
			document.getElementById("x").value=parseInt(document.getElementById("x").value)-1;
		} else if (k==65){ //a
			document.getElementById("x").value=parseInt(document.getElementById("x").value)-1;
		} else if (k==80){ //p
			sb.plotinfluence();
			return;
		}else if (k==68){ //d
			document.getElementById("x").value=parseInt(document.getElementById("x").value)+1;
		} else if (k==69 || k==13){ //e
			//document.getElementById("y").value=parseInt(document.getElementById("y").value)+1;
			var docx=parseInt(document.getElementById("x").value);
			var docy=parseInt(document.getElementById("y").value);
			sb.placeMove(docx,docy);
		} else if (k==87){ //w
			document.getElementById("y").value=parseInt(document.getElementById("y").value)-1;
			document.getElementById("x").value=parseInt(document.getElementById("x").value)+1;
		} else if (k==88){
			document.getElementById("y").value=parseInt(document.getElementById("y").value)-1;
			document.getElementById("x").value=parseInt(document.getElementById("x").value)+1;
		} else if (k==90){
			document.getElementById("y").value=parseInt(document.getElementById("y").value)-1;
		} else {
			return 0;
		}
		crosshair();
	}
}
function crosshair(){
	sb.placeMoves();
	var docx=parseInt(document.getElementById("x").value);
	var docy=parseInt(document.getElementById("y").value);
	if (sb.board.tg.has(docx,docy)){
		var st=sb.triangles[docy][docx];
		sb.drawer.line(st.pixX-sb.unitSize,st.pixY,st.pixX+sb.unitSize,st.pixY,"#909",5);
		sb.drawer.line(st.pixX,st.pixY-sb.unitSize,st.pixX,st.pixY+sb.unitSize,"#909",5);
	}
};
function changesize(){
	var s=parseInt(document.getElementById("canvassize").value);
	sb.drawer.canvas.width=s;
	sb.drawer.canvas.height=s*0.9;
	var us=parseInt(document.getElementById("unitsize").value);
	sb.unitSize=us;
	var sl=parseInt(document.getElementById("sidelength").value);
	if (sl!=sb.board.tg.sideLength){
		sb.board=new Trigo.Board(sl);
	}
	sb.updateParams();
	sb.placeMoves();
}

/*
function undo(){
	var plays=document.getElementById("board_moves").value.split("+");
	var newstr="";
	for (var i = 0; i < plays.length-1; i++) {
		newstr+=plays[i];
		if (i<plays.length-2){
			newstr+='+';
		}
	}
	//newstr+=plays[plays.length-2] || "";
	document.getElementById("board_moves").value=newstr || "#909:0,0";
	var cols=document.getElementById("board_cols").value.split(",");
	var ncols=cols[cols.length-1];
	document.getElementById("col").value=ncols;
	for (var i = 0; i < cols.length-1; i++) {
		ncols+=","+cols[i];
	}
	document.getElementById("board_cols").value=ncols;
	board.common.drawAll();
}

function submit(){
	board.submit();
	
}

function changesize(){
  var s=document.getElementById("size").value;
  board.common.drawer.canvas.width=s;
  board.common.drawer.canvas.height=s*0.9;
  board.common.drawer.updateParams();
  board.common.drawAll();
}
function line(ax){
	var o=document.getElementById(ax).value;
	board.common.drawer.gridLine(o,3,ax,"#909",o,true);
	//board.common.drawAll();
	
}*/

</script>

<footer class="footer">
  <small>
    Go is fun!
  </small>
  <nav>
    <ul>
      <li><a href="/about">About</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>
  </nav>
</footer>
      
    </div>
  </body>
</html>
